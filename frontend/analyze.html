<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Donwatch Analysis</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app">
    <div id="sidebar"></div>
    <div class="main">
      <header class="topbar">
        <h1>Analyze</h1>
      </header>
      <div class="content">
        <section class="card" id="analyze-section">
          <div class="card-header"><h2>Score History</h2></div>
          <div class="chart-wrap"><canvas id="scoreChart"></canvas></div>

          <div class="recurring-wrap">
            <h3>Recurring Findings</h3>
                         <div class="table-controls">
               <div class="filter-controls">
                 <input type="text" id="findings-filter" placeholder="Filter findings..." />
                 <select id="tool-filter">
                   <option value="">All Tools</option>
                 </select>
                 <select id="category-filter">
                   <option value="">All Categories</option>
                 </select>
                 <select id="acceptance-filter">
                   <option value="">All Risks</option>
                   <option value="accepted">Accepted Only</option>
                   <option value="unaccepted">Unaccepted Only</option>
                 </select>
                 <label class="switch" title="Show only findings present in the latest report">
                   <input type="checkbox" id="latest-only-toggle">
                   <span class="slider"></span>
                 </label>
                 <span>In latest only</span>
               </div>
               <div class="sort-controls">
                 <select id="sort-findings">
                   <option value="count-desc">Count (High to Low)</option>
                   <option value="count-asc">Count (Low to High)</option>
                   <option value="score-desc">Risk Score (High to Low)</option>
                   <option value="score-asc">Risk Score (Low to High)</option>
                   <option value="name">Name (A-Z)</option>
                   <option value="category">Category (A-Z)</option>
                 </select>
               </div>
             </div>
            <div class="table-wrap">
            <table id="recurring-table">
              <thead><tr>
                <th data-col="tool">Tool</th>
                <th data-col="category">Category</th>
                <th data-col="name">Name</th>
                <th data-col="count">Count</th>
                <th data-col="avg_score">Risk Score</th>
                <th data-col="severity">Severity</th>
                <th data-col="inLatest">In Latest?</th>
                <th data-col="accepted">Accepted?</th>
              </tr></thead>
              <tbody></tbody>
            </table>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <div id="risk-modal" class="modal hidden">
    <div class="modal-content">
      <span class="modal-close">&times;</span>
      <h2 id="risk-modal-title"></h2>
      <p><strong>Tool:</strong> <span id="risk-modal-tool"></span></p>
      <p><strong>Category:</strong> <span id="risk-modal-category"></span></p>
      <p><strong>Severity:</strong> <span id="risk-modal-severity"></span></p>
      <p><strong>Description:</strong></p>
      <p id="risk-modal-description"></p>
      <div class="modal-actions">
        <label class="switch">
          <input type="checkbox" id="risk-modal-accept-toggle">
          <span class="slider"></span>
        </label>
        <span>Accept Risk</span>
      </div>
    </div>
  </div>

  <script src="nav.js"></script>
  <script type="module" src="chartManager.js"></script>
  <script type="module" src="analysis.js"></script>
</body>
</html>
